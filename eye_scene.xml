<mujoco model="Eye Visualization">
  <compiler angle="degree" meshdir="meshes" texturedir="textures"/>
  
  <option timestep="0.002" gravity="0 0 -9.81">
    <flag contact="enable"/>
  </option>
  
  <visual>
    <global offwidth="1920" offheight="1080"/>
    <quality shadowsize="4096"/>
  </visual>
  
  <asset>
    <!-- Load eye component meshes - strip materials on import -->
    <mesh name="cornea" file="Cornea_L.obj"/>
    <mesh name="eye_interior" file="EyeInterior_L.obj"/>
    <mesh name="eye" file="Eye_L.obj"/>
    <mesh name="eye_wet" file="EyeWet_L.obj"/>
    <mesh name="lens" file="Lens_L_extracted.obj"/>
    <mesh name="inner_eyelid" file="Inner_Eyelid_L.obj"/>
    <mesh name="tear_duct" file="TearDuct_L.obj"/>
    <mesh name="cloth" file="Cloth_L.obj"/>
    <mesh name="face" file="Face_L.obj"/>

    <!-- Load surgical tool -->
    <mesh name="diathermic_tip" file="tools/diathermic_tip.obj" scale="0.001 0.001 0.001"/>

    <!-- Texture for lens (your UV map) -->
    <texture name="lens_texture" type="2d" file="lens_uv_map.png"/>
    <texture name="face_texture" type="2d" file="Eye-Face_Medium02.png"/>
    <texture name="cloth_texture" type="2d" file="Cloth_Color.png"/>
    
    <!-- Materials -->
    <material name="lens_mat" texture="lens_texture" specular="0.5" shininess="0.8"/>
    <material name="cornea_mat" rgba="0.9 0.95 1.0 0.3" specular="1.0" shininess="1.0"/>
    <material name="eye_mat" rgba="0.1 0.3 0.5 1.0"/>
    <material name="eyelid_mat" rgba="0.95 0.8 0.75 1.0"/>
    <material name="wet_mat" rgba="1.0 1.0 1.0 0.1" specular="1.0" shininess="1.0"/>
    <material name="cloth_mat" texture="cloth_texture" specular="0.3" shininess="0.3"/>
    <material name="face_mat" texture="face_texture" specular="0.3" shininess="0.3"/>
    <material name="tool_mat" rgba="0.7 0.7 0.8 1.0" specular="0.8" shininess="0.9"/>
  </asset>
  
  <worldbody>
    <!-- Lighting setup -->
    <light name="top_light" pos="0 0 5" dir="0 0 -1" diffuse="1 1 1"/>
    <light name="side_light" pos="1 0 1" dir="-1 0 -0.5" diffuse="0.5 0.5 0.5"/>
    
    <!-- Ground plane -->
    <geom type="plane" size="1 1 0.1" rgba="0.2 0.2 0.2 1"/>
    
    <!-- Coordinate axes -->
    <geom name="x_axis" type="cylinder" size="0.003 0.15" pos="0.15 0 0.001" 
          euler="0 90 0" rgba="1 0 0 1" contype="0" conaffinity="0"/>
    <geom name="y_axis" type="cylinder" size="0.003 0.15" pos="0 0.15 0.001" 
          euler="90 0 0" rgba="0 1 0 1" contype="0" conaffinity="0"/>
    <geom name="z_axis" type="cylinder" size="0.003 0.15" pos="0 0 0.15" 
          euler="0 0 0" rgba="0 0 1 1" contype="0" conaffinity="0"/>
    
    <!-- Eye assembly -->
    <body name="eye_assembly" pos="0 0 0.1">
      <!-- Lens with UV map - RENDER THIS FIRST/SEPARATELY -->
      <geom name="lens_geom" type="mesh" mesh="lens" 
            material="lens_mat" contype="0" conaffinity="0" group="0"/>
      
      <!-- Eye interior (base) -->
      <geom name="eye_interior_geom" type="mesh" mesh="eye_interior" 
            material="eye_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Main eye -->
      <geom name="eye_geom" type="mesh" mesh="eye" 
            material="eye_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Cornea (transparent) -->
      <geom name="cornea_geom" type="mesh" mesh="cornea" 
            material="cornea_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Wet layer (glossy effect) -->
      <geom name="eye_wet_geom" type="mesh" mesh="eye_wet" 
            material="wet_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Inner eyelid -->
      <geom name="inner_eyelid_geom" type="mesh" mesh="inner_eyelid" 
            material="eyelid_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Tear duct -->
      <geom name="tear_duct_geom" type="mesh" mesh="tear_duct" 
            material="eyelid_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Cloth/skin -->
      <geom name="cloth_geom" type="mesh" mesh="cloth"
            material="cloth_mat" contype="0" conaffinity="0" group="1"/>

      <!-- Face -->
      <geom name="face_geom" type="mesh" mesh="face"
            material="face_mat" contype="0" conaffinity="0" group="1"/>

      <!-- Camera positioned above the eye looking down -->
      <camera name="top_view" pos="0.03 -0.1 0.175" euler="90 0 0" fovy="45"/>
      <camera name="angle_view" pos="0.2 0.0 0.2" euler="0 90 90" fovy="45"/>
    </body>

    <body name="diathermic_tip" pos="0.04 -0.015 0.27" euler="0 0 45" mocap="true">

      <!-- Visual geometry -->
      <geom name="tool_geom" type="mesh" mesh="diathermic_tip" 
            material="tool_mat" contype="0" conaffinity="0"/>

      <!-- Tool tip marker (red sphere) -->
      <site name="tool_tip" pos="0 0.01 0.0025" size="0.0005" rgba="0 1 0 1"/>
     </body>

  </worldbody>
</mujoco>