<mujoco model="Eye Visualization">
  <compiler angle="degree" meshdir="meshes" texturedir="textures"/>
  
  <option timestep="0.002" gravity="0 0 -9.81">
    <flag contact="enable"/>
  </option>
  
  <visual>
    <global offwidth="1920" offheight="1080"/>
    <quality shadowsize="4096"/>
  </visual>
  
  <asset>
    <!-- Load eye component meshes - strip materials on import -->
    <mesh name="cornea" file="Cornea_L.obj"/>
    <mesh name="eye_interior" file="EyeInterior_L.obj"/>
    <mesh name="eye" file="Eye_L.obj"/>
    <mesh name="eye_wet" file="EyeWet_L.obj"/>
    <mesh name="lens" file="Lens_L_extracted.obj"/>
    <mesh name="inner_eyelid" file="Inner_Eyelid_L.obj"/>
    <mesh name="tear_duct" file="TearDuct_L.obj"/>
    <mesh name="cloth" file="Cloth_L.obj"/>
    <mesh name="face" file="Face_L.obj"/>

    <!-- Load surgical tool -->
    <mesh name="diathermic_tip" file="tools/diathermic_tip.obj" scale="0.001 0.001 0.001"/>

    <!-- Texture for lens (your UV map) -->
    <texture name="lens_texture" type="2d" file="lens_uv_map.png"/>
    <texture name="face_texture" type="2d" file="Eye-Face_Medium02.png"/>
    <texture name="cloth_texture" type="2d" file="Cloth_Color.png"/>
    
    <!-- Materials -->
    <material name="lens_mat" texture="lens_texture" specular="0.5" shininess="0.8"/>
    <material name="cornea_mat" rgba="0.9 0.95 1.0 0.3" specular="1.0" shininess="1.0"/>
    <material name="eye_mat" rgba="0.1 0.3 0.5 1.0"/>
    <material name="eyelid_mat" rgba="0.95 0.8 0.75 1.0"/>
    <material name="wet_mat" rgba="1.0 1.0 1.0 0.1" specular="1.0" shininess="1.0"/>
    <material name="cloth_mat" texture="cloth_texture" specular="0.3" shininess="0.3"/>
    <material name="face_mat" texture="face_texture" specular="0.3" shininess="0.3"/>
    <material name="tool_mat" rgba="0.7 0.7 0.8 1.0" specular="0.8" shininess="0.9"/>
  </asset>
  
  <worldbody>
    <!-- Lighting setup -->
    <light name="top_light" pos="0 0 5" dir="0 0 -1" diffuse="1 1 1"/>
    <light name="side_light" pos="1 0 1" dir="-1 0 -0.5" diffuse="0.5 0.5 0.5"/>
    
    <!-- Ground plane -->
    <geom type="plane" size="1 1 0.1" rgba="0.2 0.2 0.2 1"/>
    
    <!-- Coordinate axes -->
    <geom name="x_axis" type="cylinder" size="0.003 0.15" pos="0.15 0 0.001" 
          euler="0 90 0" rgba="1 0 0 1" contype="0" conaffinity="0"/>
    <geom name="y_axis" type="cylinder" size="0.003 0.15" pos="0 0.15 0.001" 
          euler="90 0 0" rgba="0 1 0 1" contype="0" conaffinity="0"/>
    <geom name="z_axis" type="cylinder" size="0.003 0.15" pos="0 0 0.15" 
          euler="0 0 0" rgba="0 0 1 1" contype="0" conaffinity="0"/>
    
    <!-- Eye assembly -->
    <body name="eye_assembly" pos="0 0 0.1">
      <!-- Lens with UV map - RENDER THIS FIRST/SEPARATELY -->
      <geom name="lens_geom" type="mesh" mesh="lens" 
            material="lens_mat" contype="0" conaffinity="0" group="0"/>
      
      <!-- Eye interior (base) -->
      <geom name="eye_interior_geom" type="mesh" mesh="eye_interior" 
            material="eye_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Main eye -->
      <geom name="eye_geom" type="mesh" mesh="eye" 
            material="eye_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Cornea (transparent) -->
      <geom name="cornea_geom" type="mesh" mesh="cornea" 
            material="cornea_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Wet layer (glossy effect) -->
      <geom name="eye_wet_geom" type="mesh" mesh="eye_wet" 
            material="wet_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Inner eyelid -->
      <geom name="inner_eyelid_geom" type="mesh" mesh="inner_eyelid" 
            material="eyelid_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Tear duct -->
      <geom name="tear_duct_geom" type="mesh" mesh="tear_duct" 
            material="eyelid_mat" contype="0" conaffinity="0" group="1"/>
      
      <!-- Cloth/skin -->
      <geom name="cloth_geom" type="mesh" mesh="cloth"
            material="cloth_mat" contype="0" conaffinity="0" group="1"/>

      <!-- Face -->
      <geom name="face_geom" type="mesh" mesh="face"
            material="face_mat" contype="0" conaffinity="0" group="1"/>

      <!-- Camera positioned above the eye looking down -->
      <camera name="top_view" pos="0.03 -0.1 0.175" euler="90 0 0" fovy="45"/>
      <camera name="angle_view" pos="0.2 0.0 0.2" euler="0 90 90" fovy="45"/>
    </body>

    <body name="diathermic_tip" pos="0.04 -0.015 0.27" euler="0 0 45" mocap="true">

      <!-- Visual geometry -->
      <geom name="tool_geom" type="mesh" mesh="diathermic_tip" 
            material="tool_mat" contype="0" conaffinity="0"/>

      <!-- Tool tip marker (red sphere) -->
      <site name="tool_tip" pos="0 0.01 0.0025" size="0.0005" rgba="1 0 0 1"/>
     </body>

      <!-- Include lens visualization elements -->
      
    <!-- LENS ANALYSIS VISUALIZATION -->
    <!-- Lens geometric center -->
    <body name="lens_center_marker" pos="0.030893 -0.007080 0.270276">
      <geom name="lens_center_sphere" type="sphere" size="0.0002" rgba="0 1 0 0.8" contype="0" conaffinity="0"/>
    </body>

    <!-- Test trajectory points (36 points) -->
    <body name="trajectory_point_0" pos="0.030893 -0.007466 0.273251">
      <geom name="traj_marker_0" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_1" pos="0.031412 -0.007512 0.273200">
      <geom name="traj_marker_1" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_2" pos="0.031914 -0.007544 0.273059">
      <geom name="traj_marker_2" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_3" pos="0.032386 -0.007563 0.272834">
      <geom name="traj_marker_3" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_4" pos="0.032812 -0.007566 0.272531">
      <geom name="traj_marker_4" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_5" pos="0.033180 -0.007555 0.272159">
      <geom name="traj_marker_5" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_6" pos="0.033478 -0.007530 0.271731">
      <geom name="traj_marker_6" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_7" pos="0.033698 -0.007491 0.271258">
      <geom name="traj_marker_7" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_8" pos="0.033833 -0.007439 0.270755">
      <geom name="traj_marker_8" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_9" pos="0.033878 -0.007376 0.270238">
      <geom name="traj_marker_9" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_10" pos="0.033833 -0.007305 0.269722">
      <geom name="traj_marker_10" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_11" pos="0.033698 -0.007227 0.269223">
      <geom name="traj_marker_11" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_12" pos="0.033478 -0.007144 0.268756">
      <geom name="traj_marker_12" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_13" pos="0.033180 -0.007059 0.268335">
      <geom name="traj_marker_13" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_14" pos="0.032812 -0.006975 0.267973">
      <geom name="traj_marker_14" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_15" pos="0.032386 -0.006894 0.267681">
      <geom name="traj_marker_15" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_16" pos="0.031914 -0.006819 0.267468">
      <geom name="traj_marker_16" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_17" pos="0.031412 -0.006751 0.267340">
      <geom name="traj_marker_17" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_18" pos="0.030893 -0.006694 0.267301">
      <geom name="traj_marker_18" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_19" pos="0.030375 -0.006649 0.267353">
      <geom name="traj_marker_19" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_20" pos="0.029872 -0.006616 0.267494">
      <geom name="traj_marker_20" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_21" pos="0.029401 -0.006598 0.267719">
      <geom name="traj_marker_21" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_22" pos="0.028975 -0.006594 0.268022">
      <geom name="traj_marker_22" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_23" pos="0.028607 -0.006605 0.268394">
      <geom name="traj_marker_23" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_24" pos="0.028308 -0.006631 0.268822">
      <geom name="traj_marker_24" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_25" pos="0.028088 -0.006670 0.269295">
      <geom name="traj_marker_25" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_26" pos="0.027954 -0.006721 0.269798">
      <geom name="traj_marker_26" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_27" pos="0.027908 -0.006784 0.270315">
      <geom name="traj_marker_27" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_28" pos="0.027954 -0.006855 0.270831">
      <geom name="traj_marker_28" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_29" pos="0.028088 -0.006934 0.271330">
      <geom name="traj_marker_29" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_30" pos="0.028308 -0.007017 0.271797">
      <geom name="traj_marker_30" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_31" pos="0.028607 -0.007101 0.272218">
      <geom name="traj_marker_31" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_32" pos="0.028975 -0.007185 0.272580">
      <geom name="traj_marker_32" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_33" pos="0.029401 -0.007266 0.272872">
      <geom name="traj_marker_33" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_34" pos="0.029872 -0.007342 0.273085">
      <geom name="traj_marker_34" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>
    <body name="trajectory_point_35" pos="0.030375 -0.007409 0.273213">
      <geom name="traj_marker_35" type="sphere" size="0.0002" rgba="1 0 1 0.6" contype="0" conaffinity="0"/>
    </body>

  </worldbody>
</mujoco>